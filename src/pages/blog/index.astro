---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";
import Grid from "../../components/Grid.astro";
import FormattedDate from "../../components/FormattedDate.astro";
import { type CollectionEntry } from "astro:content";
import { Image } from "astro:assets";

const posts = (await getCollection("blog")).sort(
    (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
) as CollectionEntry<"blog">[];

const pageTitle = "My Newest Blog Entries";
const pageDescription = "Find my blog post about something that interest me.";
---

<BaseLayout title={pageTitle} description={pageDescription}>
    <div class="wrapper stack gap-12 lg:gap-20">
        <header
            class="section-header stack gap-2 lg:gap-4"
            style="text-align: center;"
        >
            <h1>{pageTitle}</h1>
            <p>{pageDescription}</p>
        </header>

        <main>
            <Grid variant="offset">
                {
                    posts.map((post) => (
                        <li>
                            <a href={`/blog/${post.id}`} class="blog-card">
                                {post.data.heroImage && (
                                    <Image
                                        src={post.data.heroImage}
                                        alt={post.data.title}
                                    />
                                )}
                                <h3>{post.data.title}</h3>
                                <p>{post.data.description}</p>
                                <FormattedDate date={post.data.pubDate} />
                            </a>
                        </li>
                    ))
                }
            </Grid>
        </main>
    </div>
</BaseLayout>

<style>
    .blog-card {
        text-decoration: none;
        display: block;
    }
    .blog-card img {
        border-radius: 12px;
        width: 100%;
        height: auto;
    }
</style>
